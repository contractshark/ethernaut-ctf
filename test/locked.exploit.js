const assert = require('assert');
const Locked = artifacts.require('Locked');

contract('Locked', function ([_, attacker, someAddress]) {
    beforeEach(async function () {
        this.contract = await Locked.new();
    });

    it('passes the challenge by writing to struct storage pointer', async function () {
        assert.equal(await this.contract.unlocked(), false);

        await this.contract.register(
            '0x' + '0'.repeat(63) + '1',
            someAddress,
            { from: attacker }
        );

        assert.equal(await this.contract.unlocked(), true);
    });
});
