const assert = require('assert');
const NaughtCoin = artifacts.require('NaughtCoin');

contract('NaughtCoin', function ([_, player, receiver]) {
    beforeEach(async function () {
        this.contract = await NaughtCoin.new(player);
    });

    it('passes the challenge by approving and calling transferFrom', async function () {
        const totalBalance = await this.contract.balanceOf(player);

        assert(totalBalance.eq(await this.contract.totalSupply()));
        assert((await this.contract.balanceOf(receiver)).eq(0));

        // Allow ourselves to transfer all tokens, so we can then call transferFrom
        await this.contract.approve(player, totalBalance, { from: player });

        await this.contract.transferFrom(player, receiver, totalBalance, { from: player });

        assert((await this.contract.balanceOf(receiver)).eq(totalBalance));
        assert((await this.contract.balanceOf(player)).eq(0));
    });
});
